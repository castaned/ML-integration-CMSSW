# Locating and understanding CMS datasets

## Data formats

CERN has a complex data retrieval system composed of different softwares and data centers. In general, people of the experiments, *e.g.*, CMS colaborators, produce data format releases that contain information recorded by the detectors from LHC runs or generated by Monte Carlo (MC) simulations. Each release corresponds to a specific data-taking period, trigger configuration, or simulation campaign. These releases can be in formats such as RAW, RECO, AOD, MiniAOD, and NanoAOD. In particular, **NanoAOD** is the newest format, released in 2016, which stores data using ROOT TTree objects instead of CMSSW C++ object like MiniAOD or AOD. Therefore, it can be analyzed using ROOT and/or python libraries.

While the other formats contain very detailed information, they are also very large and cumbersone for analysis. NanoAOD retains the most commonly used information for analysis while dramatically reducing the data volume, and it is easier to work with becuase of its Ntuple-like format. Find more information about nanoAOD in [Exploring CMS nanoAOD](https://cms-opendata-workshop.github.io/workshop2024-lesson-exploring-cms-nanoaod/aio.html), [The CMS NanoAOD data tier](https://twiki.cern.ch/twiki/bin/view/CMSPublic/WorkBookNanoAOD#NanoAOD_format), and [cms-nanoAOD](https://gitlab.cern.ch/cms-nanoAOD).

## Using DAS to locate datasets

The **Data Aggregation System (DAS)** is the catalog that helps find the exact Logical File Names (LFNs) of the samples. It provides a unified interface to query dataset locations, metedata, and file liests acrros the distributed GRID. DAS has its own query language, and the dataset paths follow a defined structure convention:

`/PrimaryDataset/ProcessedDataset/DataTier/`

An example of an LFN:

* `/ZGToLLG_01J_5f_TuneCP5_13TeV-amcatnloFXFX-pythia8/RunIISummer20UL18NanoAODv9-106X_upgrade2018_realistic_v16_L1v1-v1/NANOAODSIM`

Where `ZGToLLG_01J_5f_TuneCP5_13TeV-amcatnloFXFX-pythia8` is the primary dataset, `RunIISummer20UL18NanoAODv9-106X_upgrade2018_realistic_v16_L1v1-v1` is the processed dataset, and `NANOAODSIM` is the data tier. There are two way to find the LFNs: using the web interface, or using the command line in a cluster that has accessed. Documentation on how to query the datasets can be found in [Locating Data Samples](https://twiki.cern.ch/twiki/bin/view/CMSPublic/WorkBookLocatingDataSamples).

## XRootD protocol for data access

Once you identify the actual LFN of your desired samples, you use the XRootD protocol to access them. **XRootD** provides a redirector service (entry point) that automatically connects you to the optimal data center (end point) baseppd on network proximity and file availability. The data is not downloaded; instead, it is read efficiently through the XRootD protocol and accessed directly from the LXPLUS cluster. For more details, see [Using Xrootd Service (AAA) for Remote Data Access](https://twiki.cern.ch/twiki/bin/view/CMSPublic/WorkBookXrootdService).
